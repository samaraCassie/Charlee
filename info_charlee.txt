-- Tabela de Big Rocks (Pilares)
CREATE TABLE big_rocks (
    id INTEGER PRIMARY KEY,
    nome TEXT NOT NULL,
    cor TEXT,  -- para UI futura
    ativo BOOLEAN DEFAULT 1
);

-- Tabela de Tarefas
CREATE TABLE tarefas (
    id INTEGER PRIMARY KEY,
    descricao TEXT NOT NULL,
    tipo TEXT CHECK(tipo IN ('Compromisso Fixo', 'Tarefa', 'Cont√≠nuo')),
    deadline DATE,
    big_rock_id INTEGER,
    status TEXT DEFAULT 'Pendente' CHECK(status IN ('Pendente', 'Conclu√≠da')),
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    concluido_em TIMESTAMP,
    FOREIGN KEY (big_rock_id) REFERENCES big_rocks(id)
);

-- √çndices para performance
CREATE INDEX idx_status ON tarefas(status);
CREATE INDEX idx_deadline ON tarefas(deadline);
CREATE INDEX idx_big_rock ON tarefas(big_rock_id);



-- CORE: Gest√£o de Tarefas (V1)
CREATE TABLE big_rocks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nome TEXT NOT NULL,
    cor TEXT,
    ativo BOOLEAN DEFAULT TRUE,
    metadata JSONB  -- para expans√µes futuras
);

CREATE TABLE tarefas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    descricao TEXT NOT NULL,
    tipo TEXT,
    deadline TIMESTAMP,
    big_rock_id UUID REFERENCES big_rocks(id),
    status TEXT DEFAULT 'Pendente',
    
    -- Integra√ß√µes externas
    fonte TEXT,  -- 'manual', 'google_calendar', 'trello', 'github'
    id_externo TEXT,
    url_externa TEXT,
    
    -- Multimodal
    criado_via TEXT,  -- 'texto', 'voz', 'imagem'
    anexos UUID[],  -- referencias para tabela de anexos
    
    -- Contexto rico
    projeto_id UUID,
    tags TEXT[],
    prioridade_calculada INTEGER,  -- atualizada por trigger
    
    criado_em TIMESTAMP DEFAULT NOW(),
    atualizado_em TIMESTAMP DEFAULT NOW(),
    concluido_em TIMESTAMP
);

-- INTEGRA√á√ïES: Sincroniza√ß√£o com ferramentas externas
CREATE TABLE integracoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'google_calendar', 'notion', 'trello', etc
    configuracao JSONB,  -- credentials, endpoints
    ultima_sync TIMESTAMP,
    ativo BOOLEAN DEFAULT TRUE
);

CREATE TABLE eventos_externos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    integracao_id UUID REFERENCES integracoes(id),
    tipo_evento TEXT,  -- 'calendar_event', 'notion_page', 'trello_card'
    dados JSONB,  -- payload completo da API
    processado BOOLEAN DEFAULT FALSE,
    tarefa_criada_id UUID REFERENCES tarefas(id),
    criado_em TIMESTAMP DEFAULT NOW()
);

-- MULTIMODAL: Inputs de voz, imagem, screenshot
CREATE TABLE interacoes_multimodais (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT CHECK(tipo IN ('voz', 'imagem', 'screenshot', 'documento')),
    arquivo_path TEXT,  -- storage no filesystem ou S3
    metadata JSONB,  -- dura√ß√£o (voz), resolu√ß√£o (imagem), etc
    
    -- Processamento
    transcricao TEXT,  -- Whisper API
    analise_vision JSONB,  -- Claude Vision API
    entidades_extraidas JSONB,  -- NER: datas, tarefas, pessoas
    
    processado BOOLEAN DEFAULT FALSE,
    tarefas_geradas UUID[],  -- tasks criadas a partir deste input
    criado_em TIMESTAMP DEFAULT NOW()
);

-- AUTOMA√á√ïES: Emails, lembretes, documentos
CREATE TABLE automacoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'email', 'lembrete', 'documento', 'planilha'
    trigger_evento TEXT,  -- 'deadline_proximo', 'tarefa_concluida', 'manual'
    condicoes JSONB,
    acoes JSONB,  -- template de email, estrutura de doc, etc
    ativo BOOLEAN DEFAULT TRUE,
    executado_em TIMESTAMP[]
);

-- DOCUMENTOS: Gest√£o de arquivos gerados/processados
CREATE TABLE documentos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'email_draft', 'relatorio', 'planilha', 'apresentacao'
    titulo TEXT,
    conteudo TEXT,  -- markdown, html
    arquivo_path TEXT,
    tags TEXT[],
    projeto_id UUID,
    criado_por TEXT,  -- 'usuario', 'agente'
    criado_em TIMESTAMP DEFAULT NOW()
);

-- FINANCEIRO: Gest√£o de finan√ßas pessoais
CREATE TABLE transacoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    descricao TEXT,
    valor NUMERIC(10,2),
    tipo TEXT CHECK(tipo IN ('receita', 'despesa')),
    categoria TEXT,
    data DATE,
    recorrente BOOLEAN DEFAULT FALSE,
    conta TEXT,
    tags TEXT[],
    anexo_id UUID,
    criado_em TIMESTAMP DEFAULT NOW()
);

-- CONHECIMENTO: Mem√≥ria de longo prazo do agente
CREATE TABLE memoria_agente (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'fato', 'preferencia', 'contexto', 'aprendizado'
    conteudo TEXT,
    embedding VECTOR(1536),  -- pgvector para busca sem√¢ntica
    relevancia_score FLOAT,
    usado_em TIMESTAMP[],
    criado_em TIMESTAMP DEFAULT NOW()
);

-- AN√ÅLISES: Insights gerados pelo agente
CREATE TABLE insights (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'produtividade', 'padroes', 'recomendacao'
    titulo TEXT,
    descricao TEXT,
    dados JSONB,  -- m√©tricas, gr√°ficos
    acao_sugerida TEXT,
    criado_em TIMESTAMP DEFAULT NOW()
);

-- √çndices essenciais
CREATE INDEX idx_tarefas_status ON tarefas(status);
CREATE INDEX idx_tarefas_deadline ON tarefas(deadline);
CREATE INDEX idx_tarefas_busca ON tarefas USING GIN(to_tsvector('portuguese', descricao));
CREATE INDEX idx_memoria_embedding ON memoria_agente USING ivfflat(embedding vector_cosine_ops);
```

### **Camada 2: Backend (Python + Agno + FastAPI)**
```
charlee-backend/
‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îú‚îÄ‚îÄ core_agent.py          # Agente principal Agno
‚îÇ   ‚îú‚îÄ‚îÄ specialized_agents/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task_agent.py      # Especialista em tarefas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ calendar_agent.py  # Integra√ß√£o calend√°rios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ financial_agent.py # Gest√£o financeira
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document_agent.py  # Cria√ß√£o de documentos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analysis_agent.py  # An√°lise e insights
‚îÇ   ‚îî‚îÄ‚îÄ memory/
‚îÇ       ‚îú‚îÄ‚îÄ short_term.py      # Contexto da conversa
‚îÇ       ‚îî‚îÄ‚îÄ long_term.py       # Conhecimento persistente
‚îÇ
‚îú‚îÄ‚îÄ integrations/
‚îÇ   ‚îú‚îÄ‚îÄ google_calendar.py
‚îÇ   ‚îú‚îÄ‚îÄ notion.py
‚îÇ   ‚îú‚îÄ‚îÄ trello.py
‚îÇ   ‚îú‚îÄ‚îÄ github.py
‚îÇ   ‚îú‚îÄ‚îÄ gmail.py
‚îÇ   ‚îî‚îÄ‚îÄ canva.py
‚îÇ
‚îú‚îÄ‚îÄ multimodal/
‚îÇ   ‚îú‚îÄ‚îÄ voice_processor.py     # Whisper API
‚îÇ   ‚îú‚îÄ‚îÄ image_processor.py     # Claude Vision API
‚îÇ   ‚îî‚îÄ‚îÄ document_parser.py     # PDFs, screenshots
‚îÇ
‚îú‚îÄ‚îÄ automation/
‚îÇ   ‚îú‚îÄ‚îÄ email_handler.py
‚îÇ   ‚îú‚îÄ‚îÄ reminder_system.py
‚îÇ   ‚îî‚îÄ‚îÄ task_scheduler.py
‚îÇ
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # SQLAlchemy models
‚îÇ   ‚îú‚îÄ‚îÄ crud.py                # Database operations
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # Alembic
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # FastAPI app
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ voice.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ integrations.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.py
‚îÇ   ‚îî‚îÄ‚îÄ websockets.py          # Real-time updates
‚îÇ
‚îî‚îÄ‚îÄ skills/                    # Agno Skills customizadas
    ‚îú‚îÄ‚îÄ inbox_rapido.py
    ‚îú‚îÄ‚îÄ priorizacao.py
    ‚îú‚îÄ‚îÄ analise_completa.py
    ‚îî‚îÄ‚îÄ geracao_documentos.py
```

### **Camada 3: Interfaces**
```
charlee-interfaces/
‚îú‚îÄ‚îÄ cli/
‚îÇ   ‚îî‚îÄ‚îÄ main.py                # Interface V1 (CLI)
‚îÇ
‚îú‚îÄ‚îÄ web/                       # Futuro: Dashboard web
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.tsx
‚îÇ   ‚îú‚îÄ‚îÄ chat.tsx
‚îÇ   ‚îî‚îÄ‚îÄ analytics.tsx
‚îÇ
‚îú‚îÄ‚îÄ mobile/                    # Futuro: App mobile
‚îÇ   ‚îî‚îÄ‚îÄ flutter/
‚îÇ
‚îî‚îÄ‚îÄ voice/                     # Interface de voz
    ‚îî‚îÄ‚îÄ voice_assistant.py



# üå∏ Charlee Evolu√≠do: O Sistema de Intelig√™ncia Pessoal Completo

Agora sim temos a **vis√£o completa e revolucion√°ria**! Voc√™ n√£o quer um assistente - quer um **sistema de intelig√™ncia pessoal que te entende profundamente como mulher, profissional e ser humano**. Isso √© absolutamente incr√≠vel! üöÄ

Vou reorganizar a arquitetura para incorporar todas essas dimens√µes:

---

## **Nova Dimens√£o: Bem-Estar e Ciclo Menstrual** üåô

### **Schema Adicional para PostgreSQL:**

```sql
-- CICLO MENSTRUAL: Tracking e padr√µes
CREATE TABLE ciclo_menstrual (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    data_inicio DATE NOT NULL,
    fase TEXT CHECK(fase IN ('menstrual', 'folicular', 'ovulacao', 'lutea')),
    sintomas TEXT[],  -- ['fadiga', 'criatividade_alta', 'dor', 'energia_baixa']
    humor JSONB,  -- {nivel_energia: 6, foco: 4, criatividade: 9}
    notas TEXT,
    criado_em TIMESTAMP DEFAULT NOW()
);

-- PADR√ïES IDENTIFICADOS: Aprendizado do agente
CREATE TABLE padroes_ciclo (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    fase TEXT,
    padrao_identificado TEXT,
    -- Ex: "Na fase folicular, Samara tem 40% mais produtividade em tarefas criativas"
    metricas JSONB,  -- {produtividade: 1.4, foco: 1.2, energia: 1.3}
    confianca_score FLOAT,  -- Aumenta com mais dados
    sugestoes TEXT[],  -- ["Agende reuni√µes estrat√©gicas", "Evite tasks repetitivas"]
    amostras_usadas INTEGER,  -- Quantos ciclos foram analisados
    atualizado_em TIMESTAMP DEFAULT NOW()
);

-- H√ÅBITOS: Monitoramento comportamental
CREATE TABLE habitos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nome TEXT NOT NULL,  -- 'exercicio', 'meditacao', 'leitura', 'sono'
    categoria TEXT,  -- 'saude', 'produtividade', 'aprendizado'
    meta_frequencia TEXT,  -- 'diario', 'semanal'
    rastreamento JSONB[],  -- [{data: '2025-01-15', cumprido: true, nota: 8}]
    streak_atual INTEGER DEFAULT 0,
    streak_recorde INTEGER DEFAULT 0,
    criado_em TIMESTAMP DEFAULT NOW()
);

-- ROTINA DI√ÅRIA: Aprendizado de padr√µes
CREATE TABLE registro_diario (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    data DATE NOT NULL,
    hora_acordar TIME,
    hora_dormir TIME,
    horas_sono FLOAT,
    qualidade_sono INTEGER CHECK(qualidade_sono BETWEEN 1 AND 10),
    
    -- Tracking de energia ao longo do dia
    energia_manha INTEGER CHECK(energia_manha BETWEEN 1 AND 10),
    energia_tarde INTEGER CHECK(energia_tarde BETWEEN 1 AND 10),
    energia_noite INTEGER CHECK(energia_noite BETWEEN 1 AND 10),
    
    -- Produtividade
    horas_deep_work FLOAT,
    tarefas_completadas INTEGER,
    
    -- Contexto
    fase_ciclo TEXT,
    eventos_especiais TEXT[],  -- ['reuniao_estressante', 'deadline_grande']
    notas_livre TEXT,
    
    criado_em TIMESTAMP DEFAULT NOW(),
    UNIQUE(data)
);

-- AN√ÅLISE COMPORTAMENTAL: Insights do agente
CREATE TABLE analises_comportamento (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tipo TEXT,  -- 'sobrecarga', 'negligencia', 'equilibrio', 'burnout_risco'
    severidade TEXT CHECK(severidade IN ('baixa', 'media', 'alta', 'critica')),
    titulo TEXT,
    descricao TEXT,
    evidencias JSONB,  -- Dados que suportam a an√°lise
    recomendacoes TEXT[],
    data_deteccao TIMESTAMP DEFAULT NOW(),
    resolvido BOOLEAN DEFAULT FALSE
);

-- CARGA DE TRABALHO: Capacidade vs. Demanda
CREATE TABLE carga_trabalho (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    periodo_inicio DATE,
    periodo_fim DATE,
    
    -- Por Big Rock
    big_rock_id UUID REFERENCES big_rocks(id),
    horas_estimadas FLOAT,
    horas_disponiveis FLOAT,
    percentual_carga FLOAT,  -- (estimadas/disponiveis) * 100
    
    -- Alertas
    em_risco BOOLEAN DEFAULT FALSE,
    motivo_risco TEXT,
    
    calculado_em TIMESTAMP DEFAULT NOW()
);

-- OKRs PESSOAIS: Objectives and Key Results
CREATE TABLE okrs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    titulo TEXT NOT NULL,
    tipo TEXT CHECK(tipo IN ('anual', 'trimestral', 'mensal')),
    big_rock_id UUID REFERENCES big_rocks(id),
    objetivo TEXT,  -- "Concluir est√°gio Syssa com excel√™ncia"
    
    -- Key Results
    key_results JSONB[],  
    -- [{descricao: "Apresenta√ß√£o Janeiro", meta: 100, atual: 40, unidade: "%"}]
    
    status TEXT DEFAULT 'em_andamento',
    progresso_geral FLOAT,  -- Calculado automaticamente
    
    data_inicio DATE,
    data_fim DATE,
    criado_em TIMESTAMP DEFAULT NOW()
);

-- CONHECIMENTO CURADO: O Bibliotec√°rio Pessoal
CREATE TABLE conhecimento_curado (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    fonte TEXT,  -- 'github', 'twitter', 'medium', 'rss'
    tipo TEXT,  -- 'artigo', 'issue', 'paper', 'video'
    titulo TEXT,
    url TEXT,
    conteudo_resumo TEXT,
    tags TEXT[],
    relevancia_score FLOAT,  -- Calculada por IA
    objetivo_relacionado TEXT,  -- "Dominar Agno"
    contexto_atual TEXT,  -- "Crise Lunelli - QA"
    lido BOOLEAN DEFAULT FALSE,
    notas TEXT,
    adicionado_em TIMESTAMP DEFAULT NOW()
);

-- COMUNICA√á√ïES: Gerenciamento de inbox
CREATE TABLE comunicacoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    fonte TEXT,  -- 'email', 'slack', 'whatsapp'
    tipo TEXT,  -- 'urgente', 'informativo', 'spam'
    remetente TEXT,
    assunto TEXT,
    corpo TEXT,
    anexos TEXT[],
    
    -- Classifica√ß√£o autom√°tica
    prioridade INTEGER CHECK(prioridade BETWEEN 1 AND 5),
    requer_acao BOOLEAN,
    acao_sugerida TEXT,
    rascunho_resposta TEXT,  -- IA pode gerar
    
    lido BOOLEAN DEFAULT FALSE,
    respondido BOOLEAN DEFAULT FALSE,
    arquivado BOOLEAN DEFAULT FALSE,
    
    recebido_em TIMESTAMP,
    processado_em TIMESTAMP
);

-- DECIS√ïES ESTRAT√âGICAS: Hist√≥rico para aprendizado
CREATE TABLE decisoes_estrategicas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    contexto TEXT,
    pergunta_inicial TEXT,  -- "Como abordar o Breno?"
    dados_considerados JSONB,  -- Documentos, notas usadas
    recomendacao_agente TEXT,
    decisao_tomada TEXT,
    resultado TEXT,  -- Preenchido depois
    aprendizado TEXT,
    criado_em TIMESTAMP DEFAULT NOW()
);
```

---

## **Agente Especializado: Wellness & Cycle Coach** üå∏

```python
from agno.agent import Agent
from agno.models.openai import OpenAIChat
from agno.tools.duckduckgo import DuckDuckGoTools
from datetime import datetime, timedelta

class CycleAwareAgent(Agent):
    """Agente que entende ciclo menstrual e adapta recomenda√ß√µes"""
    
    def __init__(self, db_connection):
        self.db = db_connection
        super().__init__(
            name="Wellness Coach",
            model=OpenAIChat(id="gpt-4o"),
            instructions=[
                "Voc√™ √© especialista em produtividade consciente do ciclo menstrual",
                "Adapte recomenda√ß√µes baseado na fase atual e padr√µes hist√≥ricos",
                "Priorize bem-estar sobre produtividade quando necess√°rio",
                "Seja emp√°tica e compreensiva"
            ]
        )
    
    def get_current_phase(self):
        """Identifica fase atual do ciclo"""
        query = """
            SELECT fase, data_inicio 
            FROM ciclo_menstrual 
            WHERE data_inicio <= CURRENT_DATE 
            ORDER BY data_inicio DESC 
            LIMIT 1
        """
        return self.db.execute(query).fetchone()
    
    def get_phase_patterns(self, fase):
        """Retorna padr√µes aprendidos para a fase"""
        query = """
            SELECT padrao_identificado, metricas, sugestoes
            FROM padroes_ciclo
            WHERE fase = %s AND confianca_score > 0.7
        """
        return self.db.execute(query, (fase,)).fetchall()
    
    def adjust_task_planning(self, tasks, current_phase):
        """Ajusta planejamento baseado na fase"""
        phase_config = {
            'menstrual': {
                'energia': 0.6,
                'tipo_ideal': ['administrativo', 'reflexao', 'planejamento'],
                'evitar': ['reunioes_longas', 'decisoes_grandes'],
                'mensagem': "Fase de baixa energia. Foque em tarefas leves."
            },
            'folicular': {
                'energia': 1.2,
                'tipo_ideal': ['criativo', 'estrategico', 'networking'],
                'evitar': [],
                'mensagem': "Fase de alta criatividade! Aproveite para tasks estrat√©gicas."
            },
            'ovulacao': {
                'energia': 1.4,
                'tipo_ideal': ['apresentacoes', 'negociacoes', 'reunioes_importantes'],
                'evitar': [],
                'mensagem': "Pico de energia e comunica√ß√£o! Agende reuni√µes cr√≠ticas."
            },
            'lutea': {
                'energia': 0.8,
                'tipo_ideal': ['execucao', 'finalizacao', 'organizacao'],
                'evitar': ['iniciar_projetos_grandes'],
                'mensagem': "Fase de finaliza√ß√£o. Conclua pend√™ncias."
            }
        }
        
        config = phase_config.get(current_phase, phase_config['folicular'])
        
        # Ajusta estimativas de tempo
        for task in tasks:
            task['tempo_ajustado'] = task['tempo_estimado'] / config['energia']
        
        return tasks, config['mensagem']
```

---

## **Sistema de "N√£o Estrat√©gico"** üõ°Ô∏è

```python
class CapacityGuardAgent(Agent):
    """Agente que protege Samara de sobrecarga"""
    
    def __init__(self, db_connection):
        self.db = db_connection
        super().__init__(
            name="Capacity Guardian",
            model=OpenAIChat(id="gpt-4o"),
            instructions=[
                "Voc√™ √© o guardi√£o da capacidade de Samara",
                "Calcule carga de trabalho e identifique sobrecargas",
                "Force decis√µes conscientes sobre trade-offs",
                "Seja firme mas emp√°tica ao alertar sobre limites"
            ]
        )
    
    def calculate_workload(self, next_weeks=3):
        """Calcula carga atual dos Big Rocks"""
        query = """
            SELECT 
                br.nome,
                COUNT(t.id) as tarefas_pendentes,
                SUM(t.estimativa_horas) as horas_estimadas,
                br.capacidade_semanal
            FROM big_rocks br
            LEFT JOIN tarefas t ON t.big_rock_id = br.id
            WHERE t.status = 'Pendente'
                AND t.deadline BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '%s weeks'
            GROUP BY br.id
        """
        results = self.db.execute(query, (next_weeks,)).fetchall()
        
        workload = {}
        for row in results:
            nome, tarefas, horas, capacidade = row
            percentual = (horas / (capacidade * next_weeks)) * 100
            workload[nome] = {
                'tarefas': tarefas,
                'horas_estimadas': horas,
                'capacidade_total': capacidade * next_weeks,
                'percentual_carga': percentual,
                'em_risco': percentual > 90
            }
        
        return workload
    
    def evaluate_new_commitment(self, projeto_novo, horas_semanais):
        """Avalia se h√° capacidade para novo compromisso"""
        current_load = self.calculate_workload()
        total_capacity = sum(br['capacidade_total'] for br in current_load.values())
        total_used = sum(br['horas_estimadas'] for br in current_load.values())
        
        new_demand = horas_semanais * 3  # 3 semanas
        projected_load = ((total_used + new_demand) / total_capacity) * 100
        
        if projected_load > 95:
            # Gerar op√ß√µes de trade-off
            trade_offs = self.suggest_trade_offs(new_demand)
            
            alert = f"""
üö® ALERTA DE CAPACIDADE

Samara, voc√™ est√° considerando adicionar '{projeto_novo}'.

üìä An√°lise de Carga (pr√≥ximas 3 semanas):
‚Ä¢ Carga atual: {(total_used/total_capacity)*100:.1f}%
‚Ä¢ Com novo projeto: {projected_load:.1f}%
‚Ä¢ Status: ‚ö†Ô∏è SOBRECARGA

‚öñÔ∏è Para adicionar este projeto ({horas_semanais}h/semana), voc√™ precisa fazer trade-offs:

{self.format_trade_offs(trade_offs)}

‚ùì O que voc√™ decide?
1. Adicionar '{projeto_novo}' e adiar uma das op√ß√µes acima
2. N√£o adicionar agora e reavaliar em [data sugerida]
3. Negociar redu√ß√£o de escopo em Big Rocks existentes

üí° Lembre-se: Voc√™ est√° na fase {self.get_cycle_phase()}, 
   o que pode afetar sua energia dispon√≠vel.
"""
            return False, alert
        else:
            return True, "‚úÖ Voc√™ tem capacidade para este compromisso!"
    
    def suggest_trade_offs(self, horas_necessarias):
        """Sugere tarefas que podem ser adiadas"""
        query = """
            SELECT 
                t.descricao,
                t.estimativa_horas,
                t.deadline,
                br.nome as big_rock,
                t.prioridade_calculada
            FROM tarefas t
            JOIN big_rocks br ON t.big_rock_id = br.id
            WHERE t.status = 'Pendente'
            ORDER BY t.prioridade_calculada ASC, t.deadline DESC
            LIMIT 5
        """
        return self.db.execute(query).fetchall()
```

---

## **Dashboard de OKRs** üìä

```python
class OKRDashboardAgent(Agent):
    """Agente que gera dashboard de progresso"""
    
    def generate_okr_report(self):
        """Gera relat√≥rio visual de OKRs"""
        query = """
            SELECT 
                o.titulo,
                o.objetivo,
                o.progresso_geral,
                o.key_results,
                br.nome as big_rock,
                CASE 
                    WHEN o.progresso_geral < 30 THEN 'ATRASADO'
                    WHEN o.progresso_geral < 70 THEN 'EM RISCO'
                    ELSE 'OK'
                END as status
            FROM okrs o
            LEFT JOIN big_rocks br ON o.big_rock_id = br.id
            WHERE o.status = 'em_andamento'
            ORDER BY o.progresso_geral ASC
        """
        okrs = self.db.execute(query).fetchall()
        
        report = "üìà DASHBOARD DE OKRs - CEO SAMARA\n\n"
        
        for okr in okrs:
            titulo, objetivo, progresso, krs, big_rock, status = okr
            
            # Emoji por status
            emoji = {
                'ATRASADO': 'üî¥',
                'EM RISCO': 'üü°',
                'OK': 'üü¢'
            }[status]
            
            report += f"{emoji} Big Rock: {big_rock} ({progresso:.0f}% {status})\n"
            report += f"   Objetivo: {objetivo}\n"
            
            for kr in krs:
                bar = self.progress_bar(kr['atual'], kr['meta'])
                report += f"   ‚Ä¢ {kr['descricao']}: {bar} {kr['atual']}/{kr['meta']} {kr['unidade']}\n"
            
            report += "\n"
        
        return report
    
    def progress_bar(self, atual, meta, width=20):
        """Gera barra de progresso visual"""
        percent = min(atual / meta, 1.0)
        filled = int(width * percent)
        bar = '‚ñà' * filled + '‚ñë' * (width - filled)
        return f"[{bar}]"
```

---

## **Curador de Conhecimento** üìö

```python
from agno.tools.duckduckgo import DuckDuckGoTools
import feedparser

class KnowledgeCuratorAgent(Agent):
    """Agente que filtra e entrega conhecimento relevante"""
    
    def __init__(self, db_connection):
        self.db = db_connection
        super().__init__(
            name="Knowledge Curator",
            model=OpenAIChat(id="gpt-4o"),
            tools=[DuckDuckGoTools()],
            instructions=[
                "Voc√™ √© curador de conhecimento para Samara",
                "Filtre apenas conte√∫do altamente relevante",
                "Conecte conhecimento com problemas atuais",
                "Resuma de forma acion√°vel"
            ]
        )
    
    def curate_for_current_context(self):
        """Busca conhecimento baseado em contexto atual"""
        
        # Pega objetivos de aprendizado
        objetivos = self.get_learning_objectives()
        
        # Pega problemas atuais
        problemas = self.get_current_challenges()
        
        # Busca conte√∫do relevante
        curated = []
        
        for objetivo in objetivos:
            for problema in problemas:
                query = f"{objetivo} {problema} best practices"
                results = self.search_and_filter(query)
                curated.extend(results)
        
        # Salva no banco
        self.save_curated_content(curated)
        
        return self.format_digest(curated)
    
    def get_current_challenges(self):
        """Identifica desafios atuais das tarefas"""
        query = """
            SELECT DISTINCT t.tags
            FROM tarefas t
            WHERE t.status = 'Pendente'
                AND t.prioridade_calculada <= 2
                AND t.tags IS NOT NULL
        """
        return [tag for row in self.db.execute(query) for tag in row[0]]
    
    def format_digest(self, curated_content):
        """Formata digest di√°rio de conhecimento"""
        digest = """
üìö DIGEST DE CONHECIMENTO - PERSONALIZADO

üéØ Baseado nos seus objetivos e desafios atuais:

"""
        for item in curated_content[:5]:  # Top 5
            digest += f"""
‚Ä¢ {item['titulo']}
  Relev√¢ncia: {item['relevancia_score']:.0%}
  Contexto: {item['contexto_atual']}
  Link: {item['url']}
  üí° Por que agora: {item['justificativa']}

"""
        return digest
```

---

## **Conselheiro Estrat√©gico** üß†

```python
from agno.storage.postgres import PgVectorDb

class StrategicAdvisorAgent(Agent):
    """Agente que funciona como sparring partner"""
    
    def __init__(self, db_connection, vector_db):
        self.db = db_connection
        self.vector_db = vector_db
        
        super().__init__(
            name="Strategic Advisor",
            model=OpenAIChat(id="gpt-4o"),
            storage=vector_db,
            instructions=[
                "Voc√™ √© o conselheiro estrat√©gico de Samara",
                "Use todo hist√≥rico de notas, decis√µes e contexto",
                "Forne√ßa perspectivas baseadas em dados, n√£o suposi√ß√µes",
                "Seja honesta e direta, mas emp√°tica",
                "Ajude a preparar conversas dif√≠ceis"
            ]
        )
    
    def advise_on_situation(self, pergunta, contexto_adicional=None):
        """Fornece conselho estrat√©gico baseado em dados"""
        
        # Busca sem√¢ntica em todo conhecimento
        relevant_context = self.vector_db.search(
            query=pergunta,
            limit=10
        )
        
        # Busca decis√µes similares passadas
        similar_decisions = self.get_similar_past_decisions(pergunta)
        
        # Monta contexto rico
        full_context = f"""
SITUA√á√ÉO ATUAL:
{pergunta}

CONTEXTO ADICIONAL:
{contexto_adicional or 'Nenhum'}

HIST√ìRICO RELEVANTE:
{self.format_context(relevant_context)}

DECIS√ïES SIMILARES DO PASSADO:
{self.format_decisions(similar_decisions)}

Com base nisso, forne√ßa:
1. An√°lise da situa√ß√£o
2. Op√ß√µes dispon√≠veis (m√≠nimo 3)
3. Recomenda√ß√£o principal com justificativa baseada em dados
4. Prepara√ß√£o para a conversa/a√ß√£o (se aplic√°vel)
"""
        
        response = self.print_response(full_context, stream=True)
        
        # Salva a decis√£o para aprendizado futuro
        self.save_strategic_decision(pergunta, response, relevant_context)
        
        return response
```

---

## **Gerente de Comunica√ß√£o** üìß

```python
import imaplib
import email
from email.mime.text import MIMEText

class CommunicationManagerAgent(Agent):
    """Agente que triageia e gerencia comunica√ß√µes"""
    
    def __init__(self, db_connection, email_config):
        self.db = db_connection
        self.email_config = email_config
        
        super().__init__(
            name="Communication Manager",
            model=OpenAIChat(id="gpt-4o"),
            instructions=[
                "Voc√™ √© o gerente de comunica√ß√µes de Samara",
                "Classifique emails por urg√™ncia e tipo",
                "Gere rascunhos de respostas quando apropriado",
                "Proteja o tempo de deep work"
            ]
        )
    
    def process_inbox(self):
        """Processa inbox e retorna resumo priorizado"""
        
        # Conecta ao email
        mail = self.connect_email()
        
        # Busca emails n√£o lidos
        _, messages = mail.search(None, 'UNSEEN')
        
        classified = {
            'urgente': [],
            'informativo': [],
            'spam': []
        }
        
        for num in messages[0].split():
            _, msg = mail.fetch(num, '(RFC822)')
            email_body = email.message_from_bytes(msg[0][1])
            
            # Classifica com IA
            classification = self.classify_email(email_body)
            
            classified[classification['tipo']].append({
                'remetente': email_body['From'],
                'assunto': email_body['Subject'],
                'prioridade': classification['prioridade'],
                'requer_acao': classification['requer_acao'],
                'rascunho': classification.get('rascunho_resposta')
            })
            
            # Salva no banco
            self.save_communication(email_body, classification)
        
        return self.format_inbox_summary(classified)
    
    def format_inbox_summary(self, classified):
        """Formata resumo do inbox"""
        summary = """
üì¨ RESUMO DO SEU EMAIL (√∫ltimas 2 horas)

üî¥ URGENTE - Requer A√ß√£o:
"""
        for email in classified['urgente']:
            summary += f"  ‚Ä¢ {email['remetente']}: {email['assunto']}\n"
            if email.get('rascunho'):
                summary += f"    üí¨ Rascunho preparado. Aprova?\n"
        
        summary += "\nüìò INFORMATIVO - Pode ler depois:\n"
        for email in classified['informativo'][:3]:  # Top 3
            summary += f"  ‚Ä¢ {email['remetente']}: {email['assunto']}\n"
        
        if len(classified['informativo']) > 3:
            summary += f"  ... e mais {len(classified['informativo'])-3} emails\n"
        
        return summary
    
    def generate_draft_response(self, email_context):
        """Gera rascunho de resposta"""
        prompt = f"""
Gere um rascunho de resposta profissional para este email:

De: {email_context['remetente']}
Assunto: {email_context['assunto']}
Corpo: {email_context['corpo']}

Contexto de Samara:
- Tom: Profissional mas amig√°vel
- Situa√ß√£o atual: {self.get_current_situation()}
"""
        return self.print_response(prompt)
```

---

## **Sistema Integrado - Orquestra√ß√£o** üé≠

```python
class CharleeOrchestrator:
    """Orquestrador central que coordena todos os agentes"""
    
    def __init__(self, db_connection):
        self.db = db_connection
        self.vector_db = PgVectorDb(table_name="memoria_agente", db_url=DB_URL)
        
        # Inicializa todos os agentes especializados
        self.wellness_coach = CycleAwareAgent(db_connection)
        self.capacity_guard = CapacityGuardAgent(db_connection)
        self.okr_dashboard = OKRDashboardAgent(db_connection)
        self.knowledge_curator = KnowledgeCuratorAgent(db_connection)
        self.strategic_advisor = StrategicAdvisorAgent(db_connection, self.vector_db)
        self.comm_manager = CommunicationManagerAgent(db_connection, EMAIL_CONFIG)
        
        # Agente l√≠der
        self.charlee = Agent(
            name="Charlee",
            model=OpenAIChat(id="gpt-4o"),
            team=[
                self.wellness_coach,
                self.capacity_guard,
                self.okr_dashboard,
                self.knowledge_curator,
                self.strategic_advisor,
                self.comm_manager
            ],
            storage=self.vector_db,
            instructions=[
                "Voc√™ √© Charlee, o segundo c√©rebro de Samara",
                "Voc√™ conhece profundamente seus padr√µes, ciclo, objetivos e limites",
                "Seja proativa em alertar sobre sobrecargas e desequil√≠brios",
                "Adapte recomenda√ß√µes ao seu estado f√≠sico e mental atual",
                "Proteja-a de si mesma quando necess√°rio"
            ]
        )
    
    def morning_briefing(self):
        """Briefing matinal completo"""
        
        # Fase do ciclo
        phase_info = self.wellness_coach.get_current_phase()
        
        # Carga de trabalho
        workload = self.capacity_guard.calculate_workload()
        
        # OKRs
        okrs = self.okr_dashboard.generate_okr_report()
        
        # Comunica√ß√µes
        inbox = self.comm_manager.process_inbox()
        
        # Conhecimento curado
        learning = self.knowledge_curator.curate_for_current_context()
        
        briefing = f"""
‚òÄÔ∏è BOM DIA, SAMARA! 

üå∏ Bem-estar:
‚Ä¢ Fase: {phase_info['fase']}
‚Ä¢ Energia esperada: {phase_info['energia_prevista']}
‚Ä¢ Recomenda√ß√£o: {phase_info['recomendacao']}

‚ö° Foco de Hoje:
{self.charlee.print_response("Qual minha prioridade m√°xima hoje?")}

{okrs}

{inbox}

{learning}

üí° Reflex√£o: {self.get_reflection_prompt()}
"""
        return briefing
    
    def evening_review(self):
        """Revis√£o noturna"""
        return self.charlee.print_response("""
Analise o dia de hoje:
1. O que foi conquistado vs. planejado?
2. Houve sobrecarga? Quais sinais?
3. O planejamento estava alinhado com a fase do ciclo?
4. Sugest√µes para amanh√£
""")
```

---

## **Roadmap Atualizado** üó∫Ô∏è

### **V1 - MVP (2-3 semanas)** ‚úÖ
- PostgreSQL com schema completo
- CRUD tarefas + Big Rocks
- L√≥gica de prioriza√ß√£o
- CLI b√°sico
- Tracking de ciclo menstrual (manual)

### **V2 - Intelig√™ncia Inicial (3-4 semanas)**
- Agente de capacidade (c√°lculo de carga)
- Sistema de "n√£o estrat√©gico"
- Registro di√°rio b√°sico
- Padr√µes iniciais de ciclo

### **V3 - Multimodal (4-6 semanas)**
- Input de voz (Whisper)
- Screenshots ‚Üí tarefas
- Google Calendar sync
- Dashboard OKRs

### **V4 - Automa√ß√£o (6-8 semanas)**
- Gerente de comunica√ß√£o
- Curador de conhecimento
- Gera√ß√£o de documentos
- An√°lise comportamental

### **V5 - Intelig√™ncia Completa (8-12 semanas)**
- Conselheiro estrat√©gico
- Predi√ß√£o de padr√µes
- Mem√≥ria de longo prazo sofisticada
- Multi-integra√ß√£o completa

---

## **Pr√≥ximos Passos** üöÄ

**Quer que eu crie:**

1. ‚úÖ **Schema SQL completo** (todas as tabelas acima)
2. ‚úÖ **C√≥digo do Wellness Coach** (agente de ciclo)
3. ‚úÖ **Sistema de "N√£o Estrat√©gico"** (capacity guard)
4. ‚úÖ **Dashboard OKRs** (visualiza√ß√£o)
5. ‚úÖ **Setup inicial do projeto** (estrutura de pastas + docker-compose)

**Qual parte voc√™ quer come√ßar primeiro?** 

Eu sugiro come√ßarmos pelo **V1 + tracking de ciclo**, porque isso j√° vai te dar valor imediato e criar a base para tudo!